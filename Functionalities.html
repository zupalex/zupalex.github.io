<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="scripts/mystyles.css">
</head>
<body>

<div class="container-master">
<div class="container-full-width">
<header>
   <h1>luaXroot Wiki</h1>
</header>
</div>

<div class="container-content">
<nav>
<iframe src="sidebar.html" style="border:none;"></iframe>
</nav>

<article>


<p><b>luaXroot</b> is combining the classic Lua interpreter with the ROOT interpreter.<br/>
In practice, it translates for the end user into something which looks very similar to the Lua console command interpreter. 
It has exactly the same functionalities: you can type commands that will be interpreter in real time, load libraries, execute scripts...</p>

<p>But in the background, a ROOT <i>TApplication</i> is running. It controls all the display functionalities and is called each time a histogram or a graph needs to be drawn or updated, 
but also when the user interacts with the <i>TCanvas</i> to zoom in or out, change the binning, or simply move the mouse over the canvas...</p>

<h2 id="the-tapplication">The TApplication (theApp)</h2>
<p>Only one instance of the <i>TApplication</i> can run for one instance of <b>luaXroot</b>. It is started on a concurrent thread when <b>luaXroot</b> launched.<br/>
A set of <i>messages</i> and <i>mutexes</i> are put in place to ensure that the user's action in the Lua command interpreter won't interfere with an action the <i>TApplication</i> is currently 
resolving, effectively putting action requests in a queue until they can be resolved.<br/>
This <i>TApplication</i> instance can be accessed through calls to <i>theApp</i> either from the Lua command interpreter or from scripts loaded later. You should though never have to call it 
except for occasional request to manually *Update* the status of the <i>TApplication</i> instance. Basically leave that alone if you are not totally sure that you absolutely need to interact with it.<p>

<h2 id="system-calls">System calls binding</h2>
<p>Though most system calls could be done through an os.execute([insert system call]) here, some of them cannot and it is sometime more convenient to have binder to Lua functions for them.<br/>
Please note that I abusively use the term <i>system call</i> for some functions but decided to group them with the actual system calls due to the type of operations they perform.<br/>
These function are documented in <a href="#">this section</a> and include calls such as <i>open</i>, <i>close</i>, <i>getenv</i>, <i>fork</i>, <i>ftruncate</i>, <i>pipe</i>, ...</p>

<h2 id="ipc">Inter-Process Communication (IPC)</h2>
<p>Most of the tools which allows 2 different processes to communicate together (either on the same machine or on 2 separate machines, over LAN or WAN) are described in <a href="#">this section</a>.<br/>
It includes message queues, semaphores, shared memory, memory mapped files and sockets.</p>

<h2 id="the-root-binders">The ROOT binders</h2>
<p>As you probably guessed from the previous paragraphs, direct calls to C or C++ functions are not how Lua works. It goes the same with all the ROOT functionalities and classes.<br/>
Binders to the most useful classes are provided and <a href="#">documented here</a>.<br/>
It includes</p>

<ul>
<li><i>TFile</i></li>
<li><i>TF1</i></li>
<li><i>TGraphErrors</i> (<i>TGraph</i> is treated as a <i>TGraphErrors</i> in <b>luaXroot</b>)</li>
<li><i>TH1D</i> (all 1D histograms are treated as TH1D in <b>luaXroot</b>)</li>
<li><i>TH2D</i> (all 2D histograms are treated as TH2D in <b>luaXroot</b>)</li>
<li><i>TCutG</i> (to make graphical selection on graphs)</li>
</ul>

<h2 id="helper-funcs">Helper functions</h2>
<p>A set of helper function to make the user's life simpler are provided. These functions goes from simple macros to more complex and effective tools.<br/>
<b>For example:</b> Often the user will want to start a task without loosing the ability the interact with the <b>luaXroot</b> session and would rather run it in the background instead. 
For this instance, the helper function <i>[StartNewTask]()</i> can be used to create a new thread that will run the requested task in the background while the user can still user the Lua 
command prompt to perform other operations. This functionality comes with a set of function to communicate with the tasks threads such as <i>[SendSignal]()</i> to send for instance a pause request to 
that running task.</p>

<h2 id="the-userlogon">The userlogon.lua</h2>
<p>When starting <b>luaXroot</b> a bunch of scripts are loaded, the main one being luaXrootlogon.lua<br/>
The core modules are loaded via calls to <a href="#">require</a> in this luaXrootlogon.lua script, as well as some general functions.<br/>
At the very end of the loading process, a call to <i>require("userlogon.lua")</i> is made. If such a script is found in the "user" folder of the <b>luaXroot</b> repository 
(it should exist at the first place but be empty save for a few line of comments. If not it is safe to create it) it is then loaded. this "user/userlogon.lua" is where the user will want to put 
any additional module that he/she would want to load at startup. Bear in mind these modules will be loaded last.</p>

<h2 id="adding-custom-classes">Adding custom classes</h2>
<p>This is an advanced topic and is <a href="#">treated in details here</a>.<br/>
Tools, helper and wrapper functions are provided to make the process of adding custom classes and interacting with them in Lua as streamlined as possible. A base class <a href="#"><i>LuaUserClass</i></a> 
is provided and any custom class should inherit from it to be able to benefit from these helpful tools.</p>


</article>
</div>

<div class="container-full-width">
<footer>https://github.com/zupalex/luaXroot</footer>
</div>
</div>

</body>
</html>